<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Building .NET nanoFramework | nanoFramework Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Building .NET nanoFramework | nanoFramework Documentation ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="building-net-nanoframework">Building .NET <strong>nanoFramework</strong></h1>

<p>.NET <strong>nanoFramework</strong> build system is based in CMake. Please read the instructions specific to each target series.</p>
<ul>
<li><a href="build-stm32.html">STM32</a></li>
<li><a href="build-esp32.html">ESP32</a></li>
<li><a href="build-nxp.html">NXP</a></li>
<li><a href="using-dev-container.html">Using Dev Container</a></li>
</ul>
<h2 id="about-this-document">About this document</h2>
<p>This document describes how to build the required images for .NET <strong>nanoFramework</strong> to be flashed in a SoC or MCU.
The build is based on CMake tool to ease the development in all major platforms.</p>
<h2 id="using-dev-container">Using Dev Container</h2>
<p>If you want a simple, efficient way, we can recommend you to use <a href="using-dev-container.html">Dev Container</a> to build your image. This has few requirements as well like Docker Desktop and Remote Container extension in VS Code but it is already all setup and ready to run!</p>
<p>If you prefer to install all the tools needed on your Windows machine, you should continue this tutorial.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>You'll need:</p>
<ul>
<li><a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads">GNU ARM Embedded Toolchain</a></li>
<li><a href="https://cmake.org/">CMake</a> (Minimum required version is 3.7)</li>
<li>A build system for CMake to generate the build files to.
<ul>
<li>If you have Visual Studio (full version) you can use the included NMake.</li>
<li>A nice alternative is <a href="https://github.com/ninja-build/ninja">Ninja</a>. This is lightweight build system, designed for speed and it works on Windows and Linux machines. See <a href="cmake/ninja-build.html">here</a> how to setup Ninja to build .NET <strong>nanoFramework</strong>.</li>
</ul>
</li>
</ul>
<p>If you are using VS Code as your development platform we suggest that you use the CMake Tools extension. This will allow you to run the builds without leaving VS Code.</p>
<ul>
<li><a href="http://code.visualstudio.com/">Visual Studio Code</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=twxs.cmake">CMake Extension</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=vector-of-bool.cmake-tools">CMake Tools Extension</a></li>
</ul>
<p>In case you specify an RTOS and you want its source to be downloaded from the official repository, you'll need:</p>
<ul>
<li>For FreeRTOS a SVN client. <a href="https://tortoisesvn.net/downloads">Tortoise SVN</a> seems to be a popular choice for Windows machines.</li>
<li>For ChibiOS a Git client. <a href="https://desktop.github.com/">GitHub Desktop</a> seems to be a popular choice for Windows machines.</li>
</ul>
<h2 id="preparation">Preparation</h2>
<p>It's <em><strong>highly</strong></em> recommended that run the build outside the source tree. This prevents you from cluttering the source tree with CMake artifacts, temporary files etc.
In fact this is enforced and checked by the CMake script.</p>
<p>In case you need to clean up or start a fresh build all you have to do is simply delete the contents of the build directory.</p>
<p>As a suggestion we recommend that you create a directory named <em>build</em> in the repository root and run CMake from there.</p>
<h2 id="build-a-net-nanoframework-image">Build a .NET <strong>nanoFramework</strong> image</h2>
<p>The build script accepts the a number of parameters (some of them are mandatory). Please check the details about each parameter <a href="cmake-tools-cmake-variants.html#content-explained">here</a>.</p>
<p><em>Note 1: The RTOS currently supported (except for ESP32 target) is ChibiOS. If no source path is specified the source files will be downloaded from nanoFramework  GitHub fork.</em>
<em>Note 2: the very first build will take more or less time depending on the download speed of the Internet connection of the machine were the build is running. This is because the source code of the RTOS of your choice will be downloaded from its repository. On the subsequent builds this won't happen.</em></p>
<p>You can specify any generator that is supported in the platform where you are building.
For more information on this check CMake documentation <a href="https://cmake.org/cmake/help/v3.7/manual/cmake-generators.7.html?highlight=generator">here</a>.</p>
<h2 id="building-from-the-command-prompt">Building from the command prompt</h2>
<p>If you are building from the command prompt, just go to your <em>build</em> directory and run CMake from there with the appropriate parameters.
The following is a working example:</p>
<pre><code class="lang-dotnetcli">cmake \
-DTOOLCHAIN_PREFIX=&quot;E:/GNU_Tools_ARM_Embedded/5_4_2016q3&quot; \
-DCMAKE_TOOLCHAIN_FILE=CMake/toolchain.arm-none-eabi.cmake \
-DCHIBIOS_BOARD=ST_NUCLEO_F091RC \
-DTARGET_SERIES=STM32F0xx \
-DNF_FEATURE_DEBUGGER=TRUE \
-DAPI_Windows.Devices.Gpio=ON \
-DNF_FEATURE_RTC=ON \
-G &quot;NMake Makefiles&quot; ../
</code></pre>
<p>This will call CMake (on your <em>build</em> directory that is assumed to be under the repository root) specifying the location of the toolchain install, that the target board is named ST_NUCLEO_F091RC, that STM32F0xx is the series name that it belongs to, debugger feature is to be included, Windows.Devices.Gpio API is to be included and that the build files suitable for NMake are to be generated.</p>
<p>Another example:</p>
<pre><code class="lang-text">cmake \
-DTOOLCHAIN_PREFIX=&quot;E:/GNU_Tools_ARM_Embedded/5_4_2016q3&quot; \
-DCMAKE_TOOLCHAIN_FILE=CMake/toolchain.arm-none-eabi.cmake \
-DCHIBIOS_SOURCE=E:/GitHub/ChibiOS \
-DCHIBIOS_BOARD=ST_NUCLEO144_F746ZG \
-DTARGET_SERIES=STM32F7xx \
-DNF_FEATURE_DEBUGGER=TRUE \
-DAPI_Windows.Devices.Gpio=ON \
-DNF_FEATURE_RTC=ON \
-G &quot;NMake Makefiles&quot; ../
</code></pre>
<p>This will call CMake (on your <em>build</em> directory that is assumed to be under the repository root) specifying the location of the toolchain install, specifying that ChibiOS sources to be used are located in the designated path (mind the forward slash and no ending slash),  that the target board is named ST_NUCLEO144_F746ZG, that STM32F7xx is the series name that it belongs to, debugger feature is to be included, Windows.Devices.Gpio API is to be included, RTC is used and that the build files suitable for NMake are to be generated.</p>
<p>After successful completion you'll have the build files ready to be used in the target build tool.</p>
<h2 id="building-from-vs-code-using-cmake-tools-extension">Building from VS Code (using CMake Tools extension)</h2>
<p>We've added the required files and configurations to help you launch your build from VS Code.
Follows a brief explanation on the files you might want to tweak.</p>
<ul>
<li>settings.json (inside .vscode folder) here you can change the generator that CMake uses to generate the build. The default is <code>&quot;cmake.generator&quot;: &quot;NMake Makefiles&quot;</code>. The recommendation is to use Ninja as the build tool because it's way faster than NMake.
You'll also need to set the use of CMake Server to true, like this: <code>&quot;cmake.useCMakeServer&quot; : true</code>.</li>
<li>launch.json (inside .vscode folder) here you can set up your launch configurations, such as gdb path or OpenOCD configuration. We've made available Gists with launch.json for several of the reference targets. Grab yours from <a href="https://gist.github.com/nfbot">here</a>. ⚠️ Remember to update paths and other preferences according to your setup and machine configuration. 😉</li>
<li>cmake-variants.json (at the repository root) here you can add several build flavors. You can even add variants to each one. Check the documentation extension <a href="https://vector-of-bool.github.io/docs/vscode-cmake-tools/variants.html#">here</a>. We've made available Gists with cmake-variants.json for each of the reference targets. Grab yours from <a href="https://gist.github.com/nfbot">here</a>. ⚠️ Remember to update paths and other preferences according to your setup and machine configuration. 😉</li>
</ul>
<p>To launch the build in VS Code check the status bar at the bottom. Select the build flavor and then click the build button (or hit F7).</p>
<h2 id="net-nanoframework-build-deliverables">.NET <strong>nanoFramework</strong> build deliverables</h2>
<p>After a successful build you can find the .NET <strong>nanoFramework</strong> image files in the <em>build</em> directory. Those are:</p>
<ul>
<li><p>nanoBooter image (not available for ESP32 builds):</p>
<ul>
<li>nanoBooter.bin (raw binary format)</li>
<li>nanoBooter.hex (Intel hex format)</li>
<li>nanoBooter.s19 (Motorola S-record format, equivalent to srec)</li>
<li>nanoBooter.lst (source code listing intermixed with disassembly)</li>
<li>nanoBooter.map (image map)</li>
</ul>
</li>
<li><p>nanoCLR image:</p>
<ul>
<li>nanoCLR.bin (raw binary format)</li>
<li>nanoCLR.hex (Intel hex format)</li>
<li>nanoCLR.s19 (Motorola S-record format, equivalent to srec)</li>
<li>nanoCLR.lst (source code listing intermixed with disassembly)</li>
<li>nanoCLR.map (image map)</li>
</ul>
</li>
</ul>
<h2 id="build_version-matching">BUILD_VERSION matching</h2>
<p>When working with self built nanoCLR you may get the following message while deploying a new app:</p>
<pre><code>Found assemblies mismatches when checking for deployment pre-check.
</code></pre>
<p>This is because the BUILD_VERSION value of your custom built nanoCLR doesn't match the one nanoframework.CoreLibrary expects.
BUILD_VERSION can be set cmake-variants.json. The value defaults to <code>&quot;0.9.99.999&quot;</code>.
Change that to the one you need at the moment, like <code>&quot;1.6.1.28&quot;</code>.</p>
<p>Don't forget to:</p>
<ul>
<li>make this change under appropriate target block, as described <a href="cmake-tools-cmake-variants.html">here</a></li>
<li>make sure you understood that VSCode have to be reloaded to these json changes have effect.</li>
<li>make sure you understood that the build folder have to be removed to these changes have effect.</li>
<li>re-select the CMake target (VSCode bottom line) to reconfigure the build.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/content/building/build-instructions.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2018 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
