<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Procedure for creating a new repository | nanoFramework Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Procedure for creating a new repository | nanoFramework Documentation ">
    <meta name="generator" content="docfx 2.43.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="procedure-for-creating-a-new-repository">Procedure for creating a new repository</h1>

<p><strong>About this document</strong></p>
<p>This document describes the recipe to create a new GitHub repository. It's meant for class libraries.</p>
<h2 id="introduction">Introduction</h2>
<p>The strict following of this procedure is required in order to maintain consistency and coherence throughout the repositories, along with taking advantage of the build tools, testing and publishing automation.
If in doubt please ask one of the senior team members.</p>
<h2 id="creating-the-repository-in-github">Creating the repository in GitHub</h2>
<ol>
<li><p>This is basically clicking the create new repository button in GitHub.</p>
<p>Note: The class libraries repositories are following the patter &quot;<strong>lib-</strong><i>namespace</i>&quot; most of the remaining repositories &quot;<strong>nf-</strong><i>some-relevant-name-here</i>&quot;. This makes it easier to spot what is what.</p>
</li>
<li><p>As we are following the <a href="http://nvie.com/posts/a-successful-git-branching-model/">GitFlow branching model</a> two branches must be created: <code>master</code> and <code>develop</code>.</p>
</li>
<li><p>Make sure to create an empty readme.md to make it easier to fork and clone the new repo.</p>
</li>
</ol>
<h2 id="adjust-the-repository-settings-part-1">Adjust the repository settings (part 1)</h2>
<ol>
<li><p>Go to the repository <strong>Settings</strong> and move into <em>Options</em>.</p>
</li>
<li><p>In the <em>Features</em> section disable Wikis, Issues and Projects.</p>
</li>
<li><p>On the <em>Merge Button</em> section disable Allow merge commits. We prefer to have tidy merges on PRs without having to bother contributors to squash commits.</p>
</li>
<li><p>Move into <em>Branches</em> and set <code>develop</code> as the default branch.</p>
</li>
</ol>
<h2 id="setup-the-cla">Setup the CLA</h2>
<ol>
<li><p>Open a browser window in Private Mode (so you can sign-in as <code>nfbot</code> and not loose you personal GitHub session).</p>
</li>
<li><p>Navigate to the <a href="https://cla-assistant.io/">CLA Assistant</a>.</p>
</li>
<li><p>Sign-in with GitHub <code>nfbot</code> account.</p>
</li>
<li><p>Click the &quot;Configure CLA&quot; button at the top left.</p>
</li>
<li><p>Select the newly created repo on the &quot;Choose a repository&quot; drop-down.</p>
</li>
<li><p>Select the &quot;nanoFramework-CLA.md&quot; in the next drop-down.</p>
</li>
<li><p>Click the &quot;Link&quot; button and agree with the next step.</p>
</li>
<li><p>On the list of the CLAs, find the new one and click on the ellipsis to the right and then 'Edit'.</p>
</li>
<li><p>Add <code>nfbot,*[bot]</code> into the field &quot;Provide user names, who doesn't need to sign the CLA&quot;. Click <em>Save</em>.</p>
</li>
</ol>
<h2 id="setup-azure-devops">Setup Azure DevOps</h2>
<ol>
<li><p>Still on that Private browser window, navigate to <a href="https://dev.azure.com/nanoframework">Azure DevOps</a>.</p>
</li>
<li><p>Click &quot;Create Project&quot;.</p>
</li>
<li><p>Name the project following the GiHub repo name but without the &quot;lib&quot; prefix. Make it <em>Public</em>, select <em>Git</em> as the version control and <em>Agile</em> as the work item process.</p>
</li>
<li><p>After the project is created and showing the Summary page, go to the <em>Project Settings</em> (cog wheel at the bottom left) and navigate to <em>Service Connections</em>.</p>
</li>
<li><p>Click &quot;New service connection&quot; and choose <em>NuGet</em>.</p>
</li>
<li><p>Enter the details for a connection named <code>MyGet</code>, with URL <code>https://api.nuget.org/v3/index.json</code> and API key from nanoFramework MyGet feed.</p>
</li>
<li><p>Repeat step 5 and enter the details for another connection named <code>NuGet</code>, with URL <code>https://www.myget.org/F/nanoframework-dev/api/v2/package</code> and API key from nanoFramework NuGet API.</p>
</li>
<li><p>Navigate to Pipelines and click &quot;New pipeline&quot;.</p>
</li>
<li><p>Choose <em>GitHub</em> on the option &quot;Where is my code?&quot; and authorize with OAuth.</p>
</li>
<li><p>On the next step select the new repository from the drop down list.</p>
</li>
<li><p>As a template choose &quot;Starter pipeline&quot; to get things moving and then click on &quot;Save and run&quot;. This happens twice to make the commit and start the very first build.</p>
</li>
<li><p>Click the ellipsis icon on the top right and go to &quot;Edit pipeline&quot;.</p>
</li>
<li><p>After the pipeline view loads, choose <em>Hosted VS2017</em> in the Agent pool list.</p>
</li>
<li><p>Move to &quot;Get sources&quot; and verify that the default branch is <code>develop</code>.</p>
</li>
<li><p>Navigate to &quot;Variables&quot; and add <code>DiscordWebhook</code> with a value taken from the Azure webhook of the &quot;build-monitor&quot; channel in our Discord server. <strong>Make sure</strong> that the variable is set to <code>secret</code> by clicking on the padlock icon.</p>
</li>
<li><p>Add another variable <code>GitHubToken</code> with a value taken from the nfbot personal tokens in GitHub. <strong>Make sure</strong> that the variable is set to <code>secret</code> by clicking on the padlock icon.</p>
</li>
<li><p>Navigate to &quot;Triggers&quot;. Make sure that the option to override YAML is <strong>not</strong> checked for &quot;Continuous integration&quot;. Uncheck the same option for &quot;Pull request validation&quot; and check the &quot;Make secrets available to builds of forks&quot;.</p>
</li>
<li><p>Click the &quot;Save&quot; button and confirm the operation on the pop-up.</p>
</li>
<li><p>Go back to the pipelines view and with the current pipeline selected, click on the ellipsis icon and then on &quot;Status badge&quot;. Copy the markdown code that shows on the pop-up. This will be required to add the correct build badges in the repo readme in a moment.</p>
</li>
</ol>
<h2 id="prepare-the-initial-commit">Prepare the initial commit</h2>
<ol>
<li><p>Fork the repo into your preferred GutHub account and clone it locally.</p>
</li>
<li><p>The best option is to copy/paste from an existing repo, so you're more efficient doing just that. Mind the name changes tough! Grab the following files:</p>
<ul>
<li>.github\PULL_REQUEST_TEMPLATE.md <em>(no changes required)</em></li>
<li>.gitignore <em>(no changes required)</em></li>
<li>.github_changelog_generator</li>
<li>azure-pipelines.yml</li>
<li>CODE_OF_CONDUCT.md <em>(no changes required)</em></li>
<li>CONTRIBUTING.md <em>(no changes required)</em></li>
<li>LICENSE <em>(no changes required)</em></li>
<li>README.md</li>
<li>template.vssettings <em>(no changes required)</em></li>
<li>source/version.json</li>
<li>source/NuGet.Config</li>
<li>update-dependencies.ps1 <em>(this is only required if this class library is a dependency of others)</em></li>
</ul>
</li>
<li><p>Open &quot;azure-pipelines.yml&quot;</p>
<ol>
<li>Rename the <code>nugetPackageName</code> variable with the new name (mind the nanoframework prefix).</li>
<li>Rename the <code>repoName</code> variable with the repo name.</li>
<li>Rename the <code>sourceFileName</code> parameter with the equivalent name. It's probably wise to wait for the first successful build of the class library and then get back here with the correct name for the assembly declaration source file.</li>
<li>If there are class libraries that depend on this one, copy the &quot;update dependencies&quot; step from CorLib &quot;azure-pipelines.yml&quot;. If there aren't just skip this step.</li>
</ol>
</li>
<li><p>Open &quot;.github_changelog_generator&quot; and set the <em>project</em> to the repo name.</p>
</li>
<li><p>Open &quot;source\version.json&quot; and set the <em>version</em> to the appropriate one. Make sure to follow our version number guidelines. In doubt please ask one of the senior team members.</p>
</li>
<li><p>Open &quot;README.md&quot;</p>
<ol>
<li>Rename the class library name occurrences with  the new name.</li>
<li>Rename the package name for the NuGet badges.</li>
<li>Replace the build status badges with the ones that you've copied from Azure DevOps. They'll be the same until there is a second pipeline for the master branch.</li>
</ol>
</li>
<li><p>Create a &quot;source&quot; folder that will hold the code files and VS Solutions and projects.</p>
</li>
<li><p>Create a folder inside &quot;source&quot; with the name of the new class library.</p>
</li>
<li><p>Add to the VS Solution the class library project. Again it's better to follow an existing one and ask in doubt.</p>
<ol>
<li>Make sure you are following the naming pattern.</li>
<li>Do not add a <code>.nuget</code> solution folder</li>
<li>Make sure you copy the <code>key.snk</code> from the initial repo (or from the CorLib repo). <strong>DO NOT</strong> create a new one.</li>
</ol>
</li>
<li><p>Rename, edit and adjust as required the &quot;nuspec&quot; files to create the NuGet packages.</p>
</li>
<li><p>Go back to &quot;azure-pipelines.yml&quot;</p>
<ol>
<li>Adjust the <code>sourceFileName</code> parameter to the file name of this new project that can be found in the stubs folder after running the build.</li>
</ol>
</li>
<li><p>Still on&quot;azure-pipelines.yml&quot; <em>and only</em> if there are class libraries that depend on this one.</p>
<ol>
<li>Adjust the <code>repositoriesToUpdate</code> list with the repo names of the class libraries that depend on this new one.</li>
</ol>
</li>
</ol>
<h2 id="adjust-the-repository-settings-part-2">Adjust the repository settings (part 2)</h2>
<ol>
<li><p>Go to the repository settings in GitHub and move into <em>Branches</em>.</p>
</li>
<li><p>Go to the rule for &quot;develop&quot; branch and change the following:</p>
<ul>
<li>Enable &quot;Require pull request reviews before merging&quot;</li>
<li>Enable &quot;Require status checks to pass before merging&quot; with the options:
<ul>
<li>&quot;Require branches to be up to date before merging&quot;</li>
<li>&quot;Status checks: nanoframework.<strong>azure-devops-project-name</strong><i>&quot;</i></li>
<li>&quot;Status checks: license/cla&quot; (for develop branch)</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="update-the-dependency-upwards">Update the dependency upwards</h2>
<p>As a minimum, the new class library depends on mscorlib. If that's the only dependency, edit the <a href="https://github.com/nanoframework/lib-CoreLibrary/blob/develop/azure-pipelines.yml"><code>azure-pipelines.yml</code></a> file there and add this new repo to the <code>repositoriesToUpdate</code> list.
Now, if it depends on others, you have to figure out which one of those is <em>at the end</em> of the dependency chain and add this new repo to <em>that</em> <code>azure-pipelines.yml</code> file. For example, <code>Windows.Devices.Gpio</code> depends on <code>CoreLibrary</code> and <code>Runtime.Events</code> (which, in turn, depends on <code>CoreLibrary</code>). Updating it's dependencies has to the triggered at <code>Runtime.Events</code> not on <code>CoreLibrary</code> because of the chained dependency.</p>
<h2 id="add-the-class-library-to-the-documentation-project">Add the class library to the documentation project</h2>
<p>If this class library has documentation that has to be published as part of nanoFramework documentation (which is most likely) it needs to be referenced in the documentation project.
Edit the documentation repo <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/azure-pipelines.yml"><code>azure-pipelines.yml</code></a> and add entries for this new repo on the clone, restore and build steps.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/articles/maintainers/creating-a-new-repo.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2018 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
